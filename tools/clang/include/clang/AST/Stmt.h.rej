*** llvm/tools/clang/include/clang/AST/Stmt.h	2010-11-19 16:45:59.000000000 -0600
--- clang/include/clang/AST/Stmt.h	2010-11-20 14:41:00.932658014 -0600
***************
*** 361,366 ****
  class NullStmt : public Stmt {
    SourceLocation SemiLoc;
  public:
!   NullStmt(SourceLocation L) : Stmt(NullStmtClass), SemiLoc(L) {}
  
    /// \brief Build an empty null statement.
--- 361,374 ----
  class NullStmt : public Stmt {
    SourceLocation SemiLoc;
+ 
+   /// \brief Whether the null statement was preceded by an empty macro, e.g:
+   /// @code
+   ///   #define CALL(x)
+   ///   CALL(0);
+   /// @endcode
+   bool LeadingEmptyMacro;
  public:
!   NullStmt(SourceLocation L, bool LeadingEmptyMacro = false)
!     : Stmt(NullStmtClass), SemiLoc(L), LeadingEmptyMacro(LeadingEmptyMacro) {}
  
    /// \brief Build an empty null statement.
***************
*** 370,373 ****
    void setSemiLoc(SourceLocation L) { SemiLoc = L; }
  
    virtual SourceRange getSourceRange() const { return SourceRange(SemiLoc); }
  
--- 378,383 ----
    void setSemiLoc(SourceLocation L) { SemiLoc = L; }
  
+   bool hasLeadingEmptyMacro() const { return LeadingEmptyMacro; }
+ 
    virtual SourceRange getSourceRange() const { return SourceRange(SemiLoc); }
  
***************
*** 380,383 ****
    virtual child_iterator child_begin();
    virtual child_iterator child_end();
  };
  
--- 390,396 ----
    virtual child_iterator child_begin();
    virtual child_iterator child_end();
+ 
+   friend class ASTStmtReader;
+   friend class ASTStmtWriter;
  };
  
***************
*** 652,668 ****
    SourceLocation IfLoc;
    SourceLocation ElseLoc;
! 
!   /// \brief True if we have code like:
!   /// @code
!   ///   #define CALL(x)
!   ///   if (condition)
!   ///     CALL(0);
!   /// @endcode
!   bool MacroExpandedInThenStmt;
! 
  public:
    IfStmt(ASTContext &C, SourceLocation IL, VarDecl *var, Expr *cond, 
!          Stmt *then, SourceLocation EL = SourceLocation(), Stmt *elsev = 0,
!          bool macroExpandedInThenStmt = false);
    
    /// \brief Build an empty if/then/else statement
--- 665,672 ----
    SourceLocation IfLoc;
    SourceLocation ElseLoc;
!   
  public:
    IfStmt(ASTContext &C, SourceLocation IL, VarDecl *var, Expr *cond, 
!          Stmt *then, SourceLocation EL = SourceLocation(), Stmt *elsev = 0);
    
    /// \brief Build an empty if/then/else statement
***************
*** 696,701 ****
    void setElseLoc(SourceLocation L) { ElseLoc = L; }
  
-   bool hasMacroExpandedInThenStmt() const { return MacroExpandedInThenStmt; }
- 
    virtual SourceRange getSourceRange() const {
      if (SubExprs[ELSE])
--- 700,703 ----
    void setElseLoc(SourceLocation L) { ElseLoc = L; }
  
    virtual SourceRange getSourceRange() const {
      if (SubExprs[ELSE])
***************
*** 714,720 ****
    virtual child_iterator child_begin();
    virtual child_iterator child_end();
- 
-   friend class ASTStmtReader;
-   friend class ASTStmtWriter;
  };
  
--- 716,719 ----
    virtual child_iterator child_begin();
    virtual child_iterator child_end();
  };
  
